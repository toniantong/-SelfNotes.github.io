<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>智能文本分隔工具</title>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    /* 其他樣式保持不變 */
    
    /* 列印媒體查詢，隱藏切換主題按鈕，移除卡片陰影與背景 */
    @media print {
      .toggle-theme {
        display: none;
      }
      .card {
        box-shadow: none;
        background: transparent !important;
      }
    }
  </style>
</head>
<body>
  <!-- 為了無障礙性，加入 aria-pressed 與 aria-label -->
  <button class="toggle-theme" onclick="toggleTheme()" aria-label="切換主題" aria-pressed="false">
    <i data-lucide="moon" aria-hidden="true"></i>
    <span>切換主題</span>
  </button>

  <div class="card">
    <!-- 此處僅舉例一個功能項目，其他裝飾性圖示均添加 aria-hidden -->
    <ul>
      <li class="feature-item">
        <div class="feature-title">
          <i data-lucide="divide" aria-hidden="true"></i>
          智能文本分段
        </div>
        <p>根據字符限制自動分段，同時保留單詞完整性</p>
      </li>
      <!-- 其他功能項目可依此格式添加 -->
    </ul>
  </div>

  <script>
    // 初始化圖示
    lucide.createIcons();

    // 主題預設與初始化（嘗試從 localStorage 中讀取使用者偏好）
    function initializeTheme() {
      const savedTheme = localStorage.getItem('theme');
      const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const isDark = savedTheme ? savedTheme === 'dark' : systemDark;
      
      if (isDark) document.documentElement.classList.add('dark');
      updateThemeButton(isDark);
    }

    // 更新主題切換按鈕的圖示與 ARIA 屬性
    function updateThemeButton(isDark) {
      const themeIcon = document.querySelector('.toggle-theme i');
      // 清空原有圖示內容
      themeIcon.innerHTML = "";
      // 根據當前主題設定圖示：深色模式顯示「sun」，否則顯示「moon」
      themeIcon.setAttribute('data-lucide', isDark ? 'sun' : 'moon');
      // 重新初始化圖示（此處先清空再建立新圖示可避免重複）
      lucide.createIcons();
      document.querySelector('.toggle-theme').setAttribute('aria-pressed', isDark);
    }

    // 切換主題，並將使用者偏好儲存至 localStorage
    function toggleTheme() {
      const isDark = document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      updateThemeButton(isDark);
    }

    // 初始載入時初始化主題
    initializeTheme();

    // 列印友善：當列印媒介改變時，若列印則移除 dark 模式
    window.matchMedia('print').addListener((e) => {
      if (e.matches) document.documentElement.classList.remove('dark');
    });
  </script>
</body>
</html>
